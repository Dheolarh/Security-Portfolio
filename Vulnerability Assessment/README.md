# Vulnerability Assessment

## Overview
This project focuses on identifying vulnerabilities within the network using tools like OpenVAS and Nessus. The assessment aims to detect critical security issues and provide actionable recommendations to mitigate risks. Two target systems were analyzed: **Metasploitable 2** (192.168.98.128) and **Windows 7** (192.168.98.129).

## Tools Used
- **OpenVAS (Greenbone Security Assistant)**: For comprehensive vulnerability scanning and reporting.
- **Nessus Essentials**: For detailed vulnerability analysis and remediation suggestions.

## Scan Results

### Target 1: Metasploitable 2 (192.168.98.128)

#### OpenVAS Scan Results
**Scan Overview**
- **Target IP**: 192.168.98.128
- **Severity Distribution**: Multiple high-severity vulnerabilities detected
- **Total Vulnerabilities**: 137 vulnerabilities identified

![OpenVAS Dashboard - Metasploitable](Openvas/metasploitable%20openvas%20(1).jpg)
*OpenVAS dashboard showing tasks by severity class with high-risk vulnerabilities*

**Critical Findings**

1. **rexec Passwordless / Unencrypted Cleartext Login**
   - **Severity**: High (10.0)
   - **Host**: 192.168.98.128
   - **Port**: 512/tcp
   - **QoD**: 80%
   - **Description**: The remote host is running a rexec service which transmits username and password unencrypted from the socket. This allows attackers to execute shell commands remotely on the affected system.
   - **Impact**: Remote command execution with compromised credentials.
   - **Solution**: Disable the rexec service and use secure alternatives like SSH instead.
   - **References**: CVE-1999-0618

   ![rexec Vulnerability Details](Openvas/metasploitable%20openvas%20(2).jpg)
   *Detailed view of rexec vulnerability detection result*

2. **Telnet Service Detection**
   - **Severity**: Log (0.0)
   - **Description**: Telnet service detected on port 23, which transmits data in cleartext.

3. **PostgreSQL Detection**
   - **Severity**: Log (0.0)
   - **Description**: PostgreSQL database service detected.

4. **MySQL/MariaDB Detection**
   - **Severity**: Log (0.0)
   - **Description**: MySQL/MariaDB service detected.

5. **Tiki Wiki CMS Groupware**
   - **Severity**: High (7.5)
   - **Description**: Multiple unspecified vulnerabilities in Tiki Wiki CMS Groupware < 4.2.

![OpenVAS Vulnerability List - Metasploitable](Openvas/metasploitable%20openvas%20(3).jpg)
*Complete vulnerability list showing various detected issues on Metasploitable*

#### Nessus Scan Results
**Scan Overview**
- **Target IP**: 192.168.98.128
- **Scan Duration**: 21 minutes
- **Severity Base**: CVSS v3.0
- **Scanner**: Local Scanner

![Nessus Scan Overview - Metasploitable](Nessus/metasploitable%20nessus%20(1).jpg)
*Nessus vulnerability scan results showing 67 total vulnerabilities*

**Critical Vulnerabilities**

1. **UnrealIRCd Backdoor Detection**
   - **Severity**: Critical (CVSS 10.0)
   - **Plugin ID**: 46882
   - **Family**: Backdoors
   - **Description**: The remote IRC server is running UnrealIRCd with a backdoor that allows an attacker to execute arbitrary code on the affected host.
   - **Impact**: Complete system compromise with arbitrary code execution.
   - **Solution**: Re-download the software, verify it using the published MD5/SHA1 checksums, and re-install it.
   - **References**: 
     - https://seclists.org/fulldisclosure/2010/jun/277
     - https://seclists.org/fulldisclosure/2010/jun/284
     - http://www.unrealircd.com/txt/unrealsecadvisory.20100612.txt
   - **Exploit Available**: True
   - **Exploit Ease**: Exploits are available

   ![UnrealIRCd Backdoor](Nessus/metasploitable%20nessus%20(2).jpg)
   *Detailed information about UnrealIRCd backdoor vulnerability*

2. **VNC Server 'password' Password**
   - **Severity**: Critical (CVSS 10.0)
   - **Description**: VNC server can be accessed remotely using default credentials.

3. **Bind Shell Backdoor**
   - **Severity**: Critical (CVSS 9.8)
   - **Description**: A shell is listening on the remote port without any authentication.

4. **SSL Version 2 and 3 Protocol Detection**
   - **Severity**: Critical (CVSS 9.8)
   - **Count**: 2 instances
   - **Description**: The remote service accepts connections encrypted using SSL 2.0 and/or SSL 3.0, which are deprecated and insecure.

![Nessus Remediation Actions - Metasploitable](Nessus/metasploitable%20nessus%20(3).jpg)
*Remediation actions available for detected vulnerabilities*

### Target 2: Windows 7 (192.168.98.129)

#### OpenVAS Scan Results
**Scan Overview**
- **Target IP**: 192.168.98.129
- **Total Vulnerabilities**: 21 vulnerabilities identified
- **Severity Distribution**: Critical (3), High (1), Medium (1), Low (0), Log (16)

![OpenVAS Dashboard - Windows 7](Openvas/windows7%20openvas%20(1).jpg)
*OpenVAS scan dashboard showing severity distribution for Windows 7 target*

**Critical Findings**

1. **OS End Of Life Detection**
   - **Severity**: High (10.0)
   - **Host**: 192.168.98.129
   - **QoD**: 80%
   - **Description**: The Windows 7 Operating System on the remote host has reached the end of life and should not be used anymore.
   - **Detection Result**: The "Windows 7" Operating System on the remote host has reached the end of life.
   - **CPE**: cpe:/o:microsoft:windows_7:-:-:-
   - **EOL date**: 2013-04-09
   - **EOL info**: https://support.microsoft.com/en-us/lifecycle/search?sort=PN&alpha=Windows%207&Filter=FilterNO
   - **Impact**: Security vulnerabilities will not be patched, making the system highly vulnerable to attacks.
   - **Solution**: Upgrade to a supported operating system version.

   ![OS End of Life Detection](Openvas/windows7%20openvas%20(2).jpg)
   *Detailed OS End of Life detection result*

2. **DCE/RPC and MSRPC Services Enumeration Reporting**
   - **Severity**: Low (0.0)
   - **Host**: 192.168.98.129
   - **Ports**: Multiple TCP ports (49152-49156)
   - **Description**: Distributed Computing Environment / Remote Procedure Calls (DCE/RPC) or MSRPC services running on the remote host can be enumerated.
   - **Detection Result**: Lists multiple Windows services including:
     - Security Center (UUID: d95afe70-a6d5-4259-822e-2c84da1ddb0d)
     - NRP server endpoint (UUID: 30adc50c-5cbc-46ce-9a0e-91914789e23c)
     - DHCP Client LRPC Endpoint
     - DHCPv6 Client LRPC Endpoint
     - Event log TCPIP
     - And many more system services
   - **Impact**: An attacker may use this fact to gain more knowledge about the remote host.
   - **Solution**: Filter incoming traffic to this port.

   ![DCE/RPC Services Enumeration](Openvas/windows7%20openvas%20(3).jpg)
   *DCE/RPC services enumeration results showing exposed Windows services*

   ![DCE/RPC Details Continued](Openvas/windows7%20openvas%20(4).jpg)
   *Additional DCE/RPC service details and solution recommendations*

#### Nessus Scan Results
**Scan Overview**
- **Target IP**: 192.168.98.129
- **Scan Duration**: An hour
- **Policy**: Basic Network Scan
- **Status**: Completed
- **Severity Base**: CVSS v3.0

![Nessus Scan Overview - Windows 7](Nessus/windows7%20nessus%20(1).jpg)
*Nessus scan results showing 22 vulnerabilities on Windows 7*

**Critical Vulnerabilities**

1. **MS11-030: Vulnerability in DNS Resolution Could Allow Remote Code Execution**
   - **Severity**: Critical (CVSS 10.0)
   - **Plugin ID**: 53514
   - **Family**: Windows
   - **Version**: 1.19
   - **Published**: April 21, 2011
   - **Modified**: October 17, 2023
   - **Description**: A flaw in the way the installed Windows DNS client processes Link-local Multicast Name Resolution (LLMNR) queries can be exploited to execute arbitrary code in the context of the NetworkService account.
   - **Note**: Windows XP and 2003 do not support LLMNR and successful exploitation on those platforms requires local access and the ability to run a special application. On Windows Vista, 2008, 7, and 2008 R2, however, the issue can be exploited remotely.
   - **Impact**: Remote code execution with NetworkService privileges.
   - **Solution**: Microsoft has released a set of patches for Windows XP, 2003, Vista, 2008, 7, and 2008 R2.
   - **References**: https://www.nessus.org/u?361871b1
   - **CVSS v2.0 Base Score**: 10.0
   - **CVSS v2.0 Temporal Score**: 8.3
   - **CVSS v2.0 Vector**: CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C
   - **CVSS v2.0 Temporal Vector**: CVSS2#E:F/RL:OF/RC:C
   - **IAVM Severity**: I

   ![MS11-030 Vulnerability](Nessus/windows7%20nessus%20(2).jpg)
   *Detailed information about MS11-030 DNS vulnerability*

2. **Unsupported Windows OS (remote)**
   - **Severity**: Critical (CVSS 10.0)
   - **Plugin ID**: 108797
   - **Version**: 1.16
   - **Published**: April 3, 2018
   - **Modified**: October 21, 2025
   - **Description**: The remote version of Microsoft Windows is either missing a service pack or is no longer supported. As a result, it is likely to contain security vulnerabilities.
   - **Detection Result**: The following Windows version is installed and not supported: Microsoft Windows 7 Professional
   - **Impact**: Lack of support implies that no new security patches for the product will be released by the vendor. As a result, it is likely to contain security vulnerabilities.
   - **Solution**: Upgrade to a supported service pack or operating system.
   - **References**: https://support.microsoft.com/en-us/lifecycle
   - **CVSS v3.0 Base Score**: 10.0
   - **CVSS v3.0 Vector**: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
   - **CVSS v2.0 Base Score**: 10.0
   - **Unsupported by vendor**: True

   ![Unsupported Windows OS](Nessus/windows7%20nessus%20(3).jpg)
   *Windows 7 unsupported OS vulnerability details*

3. **Microsoft Windows (Multiple Issues)**
   - **Severity**: Mixed (CVSS 10.0, 10.0, 8.1)
   - **Count**: 3 vulnerabilities
   - **Description**: Multiple security issues affecting Windows 7, including:
     - MS11-030: Vulnerability in DNS Resolution
     - Unsupported Windows OS
     - MS17-010: Security Update for Microsoft Windows SMB Server

   ![Windows Multiple Issues](Nessus/windows7%20nessus%20(4).jpg)
   *Summary of multiple Windows vulnerabilities grouped together*

## Summary of Critical Vulnerabilities

| Target | Tool | Vulnerability | Severity | CVSS Score | Status |
|--------|------|---------------|----------|------------|--------|
| Metasploitable 2 (192.168.98.128) | OpenVAS | rexec Passwordless Login | High | 10.0 | Unpatched |
| Metasploitable 2 (192.168.98.128) | Nessus | UnrealIRCd Backdoor | Critical | 10.0 | Exploit Available |
| Metasploitable 2 (192.168.98.128) | Nessus | VNC Default Password | Critical | 10.0 | Unpatched |
| Metasploitable 2 (192.168.98.128) | Nessus | Bind Shell Backdoor | Critical | 9.8 | Unpatched |
| Windows 7 (192.168.98.129) | OpenVAS | OS End of Life | High | 10.0 | EOL System |
| Windows 7 (192.168.98.129) | Nessus | MS11-030 DNS RCE | Critical | 10.0 | Unpatched |
| Windows 7 (192.168.98.129) | Nessus | Unsupported Windows OS | Critical | 10.0 | EOL System |

## Recommendations

### Immediate Actions (Critical Priority)
1. **Isolate Affected Systems**: Immediately disconnect Metasploitable 2 (192.168.98.128) from the production network as it contains multiple backdoors with active exploits available.
2. **Disable Insecure Services**: 
   - Disable rexec service on Metasploitable
   - Remove UnrealIRCd or reinstall from verified source
   - Change default VNC passwords or disable VNC
   - Disable Telnet and replace with SSH
3. **Windows 7 Migration**: Plan immediate migration from Windows 7 to Windows 10/11 or Windows Server 2019/2022 as the OS is end-of-life and unsupported.

### Short-Term Actions (High Priority)
4. **Apply Security Patches**: 
   - Apply MS11-030 patch for Windows 7 DNS vulnerability
   - Update all services to latest versions
   - Enable automatic security updates where possible
5. **Implement Secure Protocols**: 
   - Replace FTP with SFTP/FTPS
   - Replace Telnet with SSH
   - Replace HTTP with HTTPS
   - Disable SSL 2.0 and SSL 3.0 protocols
6. **Access Control**: 
   - Implement strong authentication mechanisms
   - Enable Multi-Factor Authentication (MFA)
   - Review and restrict DCE/RPC service exposure
   - Implement network segmentation

### Long-Term Actions (Medium Priority)
7. **Security Monitoring**: 
   - Deploy IDS/IPS solutions to detect exploitation attempts
   - Implement SIEM for centralized log management
   - Configure alerting for suspicious activities
8. **Regular Vulnerability Assessments**: 
   - Schedule monthly vulnerability scans
   - Conduct quarterly penetration testing
   - Maintain vulnerability remediation tracking
9. **Security Training**: 
   - Train IT staff on secure configuration practices
   - Implement security awareness programs
   - Establish incident response procedures

## Conclusion
The vulnerability assessment identified **critical security issues** on both target systems:

- **Metasploitable 2** is severely compromised with multiple backdoors, default credentials, and insecure services. This system should **NOT** be used in production and requires immediate isolation.
- **Windows 7** is running an unsupported, end-of-life operating system with unpatched critical vulnerabilities including remote code execution flaws. Immediate OS migration is required.

Both systems present **significant security risks** to the network. The presence of exploitable vulnerabilities with CVSS scores of 10.0 indicates that attackers can gain complete system control with minimal effort. 

**Immediate action is required** to prevent potential security breaches. Failure to address these vulnerabilities could result in:
- Complete system compromise
- Data theft or destruction
- Lateral movement to other network systems
- Ransomware attacks
- Compliance violations

By implementing the recommended remediation actions, the organization can significantly improve its security posture and reduce the risk of successful cyberattacks.